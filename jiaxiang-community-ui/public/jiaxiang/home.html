<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/home.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>

<body>
<div class="content" id="abc">
    <div class="content-1">
        <h1>嘉和社区</h1>
    </div>
    <div class="content-2">
        <div class="con2-1">
            <h2 style="margin-bottom: 12px;margin-left: 16px;
                    margin-left: 16px; display: flex;justify-content: space-between;">
                <span>社区活动</span>
                <span class="nav-button"
                      style="width: 60px; height: auto; background:url('img/home_more.png') no-repeat"
                      data-target="shequhuodong"></span>
            </h2>
            <div class="carousel-container">
                <button class="carousel-btn prev">
                    <i class="fas fa-chevron-left"></i>
                </button>

                <div class="carousel">
                </div>

                <button class="carousel-btn next">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
        <div class="con2-2">
            <button class="con22-1 nav-button" data-target="notifications">
                <img src="img/service-icon.png" alt="为民服务"> <span style="font-size: 30px;">为民服务</span>
            </button>
            <button class="con22-2 nav-button" data-target="users">
                <img src="img/affair-icon.png" alt="为民办事"> <span style="font-size: 30px;">为民办事</span>
            </button>
            <button class="con22-3 nav-button" data-target="reports">
                <img src="img/list-icon.png" alt="履职清单"> <span style="font-size: 30px;">履职清单</span>
            </button>
        </div>
    </div>
    <div class="content-3">
        <h2>社区简介</h2>
        <p>
            嘉和社区是一个充满温暖与活力的居住区域，致力于为居民提供舒适、安全、便捷的生活环境。
            社区定期举办各类活动，包括健康讲座、体育赛事、环保行动等，以增强邻里关系，促进社区文化建设。
            我们的目标是打造一个和谐美好的社区，提升居民的幸福感，提供各种便民服务，创造更加美好的生活体验。
            嘉和社区坚持“党建为核、治理为基、服务为本”，积极整合社区资源、搭建治理平台、凝聚社会力量，打造
            了“幸福嘉 和邻里”的社区品牌，引导各方力量共同参与社区治理，不断提升居民在社区生活的获得感、幸福感。
        </p>
        <!-- 按钮 -->
        <div class="community-buttons">
            <button class="nav-button" data-target="dashboard">
                <img src="img/icon_search.png" alt="查看详细"> 查看详细
            </button>
            <button class="nav-button" data-target="users">
                <img src="img/sqry_icon.png" alt="社区荣誉"> 社区荣誉
            </button>
        </div>
    </div>
</div>
<script src="./config/api-urls.js"></script>
<script>
    document.querySelectorAll('.nav-button').forEach(button => {
        button.addEventListener('click', function () {
            const target = this.getAttribute('data-target');
            // 构建目标URL
            let url = 'sidebar.html?target=' + target;
            // 跳转到目标页面
            window.location.href = url;
        });
    });

    document.addEventListener('DOMContentLoaded', async function () {
        const carousel = document.querySelector('.carousel');
        const prevBtn = document.querySelector('.prev');
        const nextBtn = document.querySelector('.next');

        const response = (await (await fetch(window.API_URLS.list_community_activities(1,999))).json()).data;
        const carouselContent = response.reduce((acc, item, index, arr) => {
            index++;
            acc += `
                    <div class="carousel-item" data-id="service${index}">
                        <img src="${item.images}" alt="Image ${index}" class="carousel-img">
                        <div class="carousel-text">
                            <h3>${item.title}</h3>
                            <p>${item.startTime}</p>
                        </div>
                    </div>
            `
            return acc;
        }, "");
        carousel.innerHTML = carouselContent;

        const items = document.querySelectorAll('.carousel-item');

        // 为每个活动项添加点击事件
        items.forEach(item => {
            item.addEventListener('click', function () {
                const itemId = this.getAttribute('data-id');
                // 构建目标URL
                let url = 'sidebar.html?target=shequhuodong&id=' + itemId;
                // 跳转到目标页面
                window.location.href = url;
            });
        });


        let currentIndex = 0;
        let itemWidth = items[0].offsetWidth + 20; // 包含margin
        window.onresize = function (){
            itemWidth = items[0].offsetWidth + 20;
            updateCarousel()
        }

        function updateCarousel() {
            carousel.style.transform = `translateX(-${currentIndex * itemWidth}px)`;

            // 禁用/启用按钮
            prevBtn.disabled = currentIndex === 0;
            nextBtn.disabled = currentIndex >= items.length - 3;
        }

        prevBtn.addEventListener('click', function () {
            if (currentIndex > 0) {
                currentIndex--;
                updateCarousel();
            }
        });

        nextBtn.addEventListener('click', function () {
            if (currentIndex < items.length - 3) {
                currentIndex++;
                updateCarousel();
            }
        });

        // 响应式调整
        window.addEventListener('resize', function () {
            const newItemWidth = items[0].offsetWidth + 20;
            if (newItemWidth !== itemWidth) {
                carousel.style.transform = `translateX(-${currentIndex * newItemWidth}px)`;
            }
        });
    });
</script>

</body>

</html>